---
title: "Readme"
author: Robin Linacre
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  md_document:
    variant: markdown_github
---

[![Coverage Status](https://img.shields.io/codecov/c/github/moj-analytical-services/xltabr/dev.svg)](https://codecov.io/github/moj-analytical-services/xltabr?branch=dev)
[![Build Status](https://travis-ci.org/moj-analytical-services/xltabr.svg?branch=dev)](https://travis-ci.org/moj-analytical-services/xltabr)

## Introduction

xltabr allows you to write formatted cross tabulations to Excel using [`openxlsx`](https://github.com/awalker89/openxlsx).  It has been developed to help automate the process of publishing official statistics.

The user provides a dataframe, which is outputted to Excel with various types of rich formatting such as totals and subtotals shown with various degrees of emphasis, number formatting, etc.

The package works best when the input dataframe is the output of a crosstabulation performed by `reshape2:dcast`.  This allows the package to autorecognise key elements of a cross tabulation, such as which element form the body, and which elements form the headers.

## Getting started

Much of `xltabr` utility comes from its ability to automatically format cross tabulations which have been produced by `reshape2:dcast`.

The package provides a core convenience function called `xltabr::auto_crosstab_to_xl`. This wraps more advanced functionality, at the cost of reducing flexibility. 

A simple example is as follows

```{r, eval=FALSE, include=TRUE}
ct <- reshape2::dcast(mtcars, am + gear ~ cyl, value.var= "mpg", margins=c("am", "gear"), fun.aggregate = mean)
wb <- xltabr::auto_crosstab_to_xl(ct)
openxlsx::openXL(wb)
```

The simplest use is to write an aribtary data.frame to an in memory openxlsx workbook, ready to be written to disk:

```{r, eval=FALSE, include=TRUE}
wb <- xltabr::auto_df_to_xl(mtcars)
openxlsx::openXL(wb)
```



### Options 

```{r include=FALSE}
tools::Rd2txt_options(underline_titles = FALSE)
tools::Rd2txt("../man/auto_crosstab_to_xl.Rd")
```

## Advanced usage

## Some diagrams

See [here](https://drive.google.com/file/d/0BwYwuy7YhhdxY2hGQnVGNFN6QkE/view?usp=sharing)

This documentation was automatically generated on `r format(Sys.time(), '%d %B, %Y')` by [Travis CI](https://travis-ci.org/).
